<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_03) on Sat Dec 03 11:00:58 EST 2016 -->
<TITLE>
HVServerProtocol
</TITLE>

<META NAME="date" CONTENT="2016-12-03">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="HVServerProtocol";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../hvserver/HVServer.html" title="class in hvserver"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../hvserver/HVServerThread.html" title="class in hvserver"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?hvserver/HVServerProtocol.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HVServerProtocol.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
hvserver</FONT>
<BR>
Class HVServerProtocol</H2>
<PRE>
java.lang.Object
  <IMG SRC="../resources/inherit.gif" ALT="extended by "><B>hvserver.HVServerProtocol</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>HVServerProtocol</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
This class implements two type of protocol to process incoming command 
  messages. The first type of protocol(RAWPROTOCOL) is original hvmainframe command messages string
  with additional number of hvmainframe in frame list, that sending directly to hvmainframe.
  The second type is protocol(MAPPROTOCOL) to control hvchannels parameters by addressing channels 
  in detector map coordinates x,y.
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>2.0 
  Last update:23-Aug-05
  Mod&Add: 23-Aug-05 add correction for axis index, if it starts not from '1'
  Mod&Add: 04-Aug-05 changing parameter (instead hvmap Vector, we using hvmt Hashtable with stored HVMapTables),
           in 'convertToIndex() change conversion formula for different direction of axis(X,Y)
           add new method 'getMapName()' to extract 'mapname' from command message;
           change command message in maprotocol to: <mapname> <command> <parameter> <address_list>
           28 Feb 2005 add searching address of hvframe only in form 'hostname:port'
           18 May 2001
           22 Nov 2001 in rawprotocol serch for hvframe by index using hostnames vector</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../hvtools/HVListener.html" title="interface in hvtools">HVListener</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#notify">notify</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#HVServerProtocol(java.util.Hashtable, java.util.Hashtable)">HVServerProtocol</A></B>(java.util.Hashtable&nbsp;hvft,
                 java.util.Hashtable&nbsp;hvmt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#HVServerProtocol(java.util.Hashtable, java.util.Hashtable, hvtools.HVListener)">HVServerProtocol</A></B>(java.util.Hashtable&nbsp;hvft,
                 java.util.Hashtable&nbsp;hvmt,
                 <A HREF="../hvtools/HVListener.html" title="interface in hvtools">HVListener</A>&nbsp;notify)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.Object</CODE></FONT></TD>
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#getChannelStatus(java.lang.String, java.lang.String)">getChannelStatus</A></B>(java.lang.String&nbsp;chnaddr,
                 java.lang.String&nbsp;propname)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns channels property value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#next()">next</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#processCmd(int, java.util.Vector, java.lang.String)">processCmd</A></B>(int&nbsp;cmd,
           java.util.Vector&nbsp;chind,
           java.lang.String&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#processInput(java.lang.String)">processInput</A></B>(java.lang.String&nbsp;theInput)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process input string comman message and return reply message</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../hvserver/HVServerProtocol.html#processUpDown(java.util.Vector, java.lang.String, int)">processUpDown</A></B>(java.util.Vector&nbsp;chind,
              java.lang.String&nbsp;value,
              int&nbsp;up)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process command "UP" and "DOWN" .</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="notify"><!-- --></A><H3>
notify</H3>
<PRE>
public <A HREF="../hvtools/HVListener.html" title="interface in hvtools">HVListener</A> <B>notify</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="HVServerProtocol(java.util.Hashtable, java.util.Hashtable)"><!-- --></A><H3>
HVServerProtocol</H3>
<PRE>
public <B>HVServerProtocol</B>(java.util.Hashtable&nbsp;hvft,
                        java.util.Hashtable&nbsp;hvmt)</PRE>
<DL>
<DL>
<DT><B>Parameters:</B><DD><CODE>hvft</CODE> - Hashtable with stored hvframe objects in system<DD><CODE>hvmap</CODE> - Vector with hvchannel address in format 'hostname:port.module_slot_number.channel_number',
              index of hvchannel address in hvmap is coresponded to x,y coordinates of detector map by expression:
              index = XMAX*YMAX - XMAX*(y-1) - x -1<DT><B>See Also:</B><DD><CODE>HVmapTable</CODE></DL>
</DL>
<HR>

<A NAME="HVServerProtocol(java.util.Hashtable, java.util.Hashtable, hvtools.HVListener)"><!-- --></A><H3>
HVServerProtocol</H3>
<PRE>
public <B>HVServerProtocol</B>(java.util.Hashtable&nbsp;hvft,
                        java.util.Hashtable&nbsp;hvmt,
                        <A HREF="../hvtools/HVListener.html" title="interface in hvtools">HVListener</A>&nbsp;notify)</PRE>
<DL>
<DL>
<DT><B>Parameters:</B><DD><CODE>hvft</CODE> - Hashtable with stored hvframe objects in system<DD><CODE>hvmap</CODE> - Vector with hvchannel address in format 'hostname:port.module_slot_number.channel_number',
              index of hvchannel address in hvmap is coresponded to x,y coordinates of detector map by expression:
              index = XMAX*YMAX - XMAX*(y-1) - x -1<DD><CODE>notify</CODE> - HVListener to send status messages<DT><B>See Also:</B><DD><CODE>HVmapTable</CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="processInput(java.lang.String)"><!-- --></A><H3>
processInput</H3>
<PRE>
public java.lang.String <B>processInput</B>(java.lang.String&nbsp;theInput)</PRE>
<DL>
<DD>Process input string comman message and return reply message
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>theInput</CODE> - String input command message
<DT><B>Returns:</B><DD>String with replay message</DL>
</DD>
</DL>
<HR>

<A NAME="next()"><!-- --></A><H3>
next</H3>
<PRE>
public boolean <B>next</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processCmd(int, java.util.Vector, java.lang.String)"><!-- --></A><H3>
processCmd</H3>
<PRE>
public void <B>processCmd</B>(int&nbsp;cmd,
                       java.util.Vector&nbsp;chind,
                       java.lang.String&nbsp;value)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processUpDown(java.util.Vector, java.lang.String, int)"><!-- --></A><H3>
processUpDown</H3>
<PRE>
public java.lang.String <B>processUpDown</B>(java.util.Vector&nbsp;chind,
                                      java.lang.String&nbsp;value,
                                      int&nbsp;up)</PRE>
<DL>
<DD>Process command "UP" and "DOWN" . Calculate new value for demand voltage for requested channels and
 send its to mainframe.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>chind</CODE> - Vector list of channel addresses<DD><CODE>value</CODE> - String value for changing current settings<DD><CODE>up</CODE> - int parameter, if up=1 process 'UP' command, if up=-1, process "DOWN command
<DT><B>Returns:</B><DD>String error messag from mainframe or null if no errror</DL>
</DD>
</DL>
<HR>

<A NAME="getChannelStatus(java.lang.String, java.lang.String)"><!-- --></A><H3>
getChannelStatus</H3>
<PRE>
public java.lang.Object <B>getChannelStatus</B>(java.lang.String&nbsp;chnaddr,
                                         java.lang.String&nbsp;propname)</PRE>
<DL>
<DD>Returns channels property value.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>chnaddr</CODE> - String address of channel. String in format: H#.S#S#.C#C#
                  H# - hostname:portnumber of hvframe
                  S#S# - two digit slot number (0-15)
                  C#C# - two digit channel number (0-11)<DD><CODE>propname</CODE> - String string with property name</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../hvserver/HVServer.html" title="class in hvserver"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../hvserver/HVServerThread.html" title="class in hvserver"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?hvserver/HVServerProtocol.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HVServerProtocol.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
